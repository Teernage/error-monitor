<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Error Monitor SDK é¶åœº</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
          Helvetica, Arial, sans-serif;
        padding: 20px;
        max-width: 800px;
        margin: 0 auto;
      }
      h1 {
        color: #333;
      }
      .btn-group {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }
      button {
        padding: 12px 20px;
        font-size: 14px;
        cursor: pointer;
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        border-radius: 6px;
        transition: all 0.2s;
      }
      button:hover {
        background-color: #e0e0e0;
        transform: translateY(-1px);
      }
      button:active {
        transform: translateY(1px);
      }
      .danger {
        color: #d32f2f;
        border-color: #d32f2f;
        background-color: #ffebee;
      }
      .danger:hover {
        background-color: #ffcdd2;
      }
    </style>
  </head>
  <body>
    <h1>ğŸ¯ Error Monitor SDK é¶åœº</h1>
    <p>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è§¦å‘é”™è¯¯ï¼Œè§‚å¯Ÿ<b>ç»ˆç«¯æ§åˆ¶å°</b>çš„æŠ¥é”™è¾“å‡ºã€‚</p>

    <div class="btn-group">
      <button class="danger" id="btn-js">ğŸ’¥ è§¦å‘ JS è¿è¡Œæ—¶é”™è¯¯</button>
      <button class="danger" id="btn-promise">ğŸ’¥ è§¦å‘ Promise Reject</button>
      <button class="danger" id="btn-xhr">ğŸ’¥ è§¦å‘ XHR è¯·æ±‚å¤±è´¥</button>
      <button class="danger" id="btn-fetch">ğŸ’¥ è§¦å‘ Fetch è¯·æ±‚å¤±è´¥</button>
      <button class="danger" id="btn-resource">
        ğŸ’¥ è§¦å‘ èµ„æºåŠ è½½å¤±è´¥ (404)
      </button>
    </div>

    <script src="https://unpkg.com/error-monitor-sdk/dist/index.umd.js"></script>

    <script>
      console.log('SDK æ­£åœ¨åˆå§‹åŒ– (CDNæ¨¡å¼)...', ErrorMonitor);

      // UMD æ¨¡å¼ä¸‹ï¼ŒSDK ä¼šæŒ‚è½½åˆ° window.ErrorMonitor (åœ¨ rollup.config.js ä¸­é…ç½®çš„ name)
      ErrorMonitor.initErrorMonitor({
        reportUrl: 'http://localhost:3000/error-report',
        projectName: 'Test-Playground',
        environment: 'dev',
      });

      // 1. JS Error
      document.getElementById('btn-js').onclick = () => {
        const obj = {};
        console.log(obj.notExist.func()); // å…¸å‹é”™è¯¯
      };

      // 2. Promise Rejection
      document.getElementById('btn-promise').onclick = () => {
        Promise.reject(new Error('è¿™æ˜¯ä¸€ä¸ªæœªæ•è·çš„ Promise é”™è¯¯ï¼'));
      };

      // 3. XHR Error
      document.getElementById('btn-xhr').onclick = () => {
        const xhr = new XMLHttpRequest();
        xhr.open('GET', 'http://localhost:9999/not-exist'); // ç«¯å£ä¸å­˜åœ¨
        xhr.send();
      };

      // 4. Fetch Error
      document.getElementById('btn-fetch').onclick = () => {
        fetch('http://localhost:9999/not-exist'); // ç«¯å£ä¸å­˜åœ¨
      };

      // 5. Resource Error
      document.getElementById('btn-resource').onclick = () => {
        const img = document.createElement('img');
        img.src = '/404-image.png'; // å›¾ç‰‡ä¸å­˜åœ¨
        document.body.appendChild(img);
        // ç¨åç§»é™¤ä»¥å…å½±å“ç¾è§‚
        setTimeout(() => document.body.removeChild(img), 100);
      };
    </script>
  </body>
</html>
